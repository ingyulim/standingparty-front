<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>방 입장 - Standing Party</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div class="room-container">
    <button class="btn-back" onclick="location.href='index.html'">← 나가기</button>

    <header class="room-header glass-card">
      <h1 id="roomTitle">Standing Party</h1>
      <p id="userInfo"></p>
    </header>

    <nav class="room-tabs glass-card">
      <button id="participantsTabBtn" class="tab-btn active" onclick="switchTab('participants')">
        👥 참여자 (<span id="participantCount">0</span>)
      </button>
      <button id="missionsTabBtn" class="tab-btn" onclick="switchTab('missions')" style="display: none">
        🧩 미션 (<span id="missionCount">0</span>)
      </button>
      <button id="bingoTabBtn" class="tab-btn" onclick="switchTab('bingo')" style="display: none">
        🎲 빙고
      </button>
    </nav>

    <section id="tab-participants" class="tab-content glass-card">
      <div id="participantList" class="list-box"></div>
    </section>

    <section id="tab-missions" class="tab-content glass-card hidden">
      <div class="my-points-section">
        <h3>내 포인트</h3>
        <div class="points-display" id="myPoints">0점</div>
      </div>
      <div id="missionList" class="list-box"></div>
      <div class="mission-progress-section">
        <div class="progress-text" id="missionProgressText">0 / 0 완료</div>
        <div class="progress-bar">
          <div class="progress-fill" id="missionProgressFill"></div>
        </div>
      </div>
    </section>

    <section id="tab-bingo" class="tab-content glass-card hidden">
      <div id="bingoGrid" class="bingo-grid"></div>
    </section>
  </div>

  <!-- 미션 제출 모달 -->
  <div id="missionModal" class="modal-overlay" style="display: none !important;" onclick="closeMissionModal()">
    <div class="modal-container" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h3 id="missionModalTitle">미션</h3>
        <button class="modal-close" onclick="closeMissionModal()">✕</button>
      </div>
      <div class="modal-body">
        <div class="modal-question">
          <p id="missionModalDescription"></p>
        </div>
        <div class="modal-input-group">
          <label>상대방 코드</label>
          <input type="text" id="missionModalCode" placeholder="상대방 코드를 입력하세요..." />
        </div>
        <div class="modal-input-group">
          <label>사진 첨부 (선택)</label>
          <input type="file" id="missionModalPhoto" accept="image/*" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; width: 100%; box-sizing: border-box;" />
          <div id="missionPhotoPreview" style="display: none; margin-top: 8px;">
            <img id="missionPhotoPreviewImg" style="max-width: 100%; border-radius: 8px;" />
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-modal-cancel" onclick="closeMissionModal()">취소</button>
        <button class="btn-modal-submit" onclick="submitMissionAnswer()">제출</button>
      </div>
    </div>
  </div>

  <!-- 빙고 미션 제출 모달 -->
  <div id="bingoModal" class="modal-overlay" style="display: none !important;" onclick="closeBingoModal()">
    <div class="modal-container" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h3 id="modalTitle">미션</h3>
        <button class="modal-close" onclick="closeBingoModal()">✕</button>
      </div>
      <div class="modal-body">
        <div class="modal-question">
          <p id="modalQuestion"></p>
        </div>
        <div class="modal-input-group">
          <label>답변</label>
          <textarea id="modalAnswer" placeholder="답변을 입력하세요..." rows="4"></textarea>
        </div>
        <div class="modal-input-group" id="photoSection" style="display: none;">
          <label id="photoRequiredLabel" style="display: none;">
            <input type="checkbox" id="modalPhotoRequired" disabled /> 사진 첨부 필요
          </label>
          <input type="file" id="modalPhoto" accept="image/*" style="display: none;" />
          <button id="photoUploadBtn" class="btn-photo-upload" style="display: none;" onclick="document.getElementById('modalPhoto').click()">
            📷 사진 첨부
          </button>
          <div id="photoPreview" style="display: none; margin-top: 8px;">
            <img id="photoPreviewImg" style="max-width: 100%; border-radius: 8px;" />
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-modal-cancel" onclick="closeBingoModal()">취소</button>
        <button class="btn-modal-submit" onclick="submitBingoAnswer()">제출</button>
      </div>
    </div>
  </div>

  <script src="js/common.js"></script>
  <script src="js/room.js"></script>
</body>
</html>
